# 桥接模式

相信各位对"奶茶"这种产品不陌生吧？"奶茶"可以说是现在年亲人最爱的饮品之一，各种奶茶店分布在大街小巷，奶茶店靠着人流和品牌赚的彭满钵满，当你看到这些奶茶店的高额利润的时候，不免蠢蠢欲动，想开一家自己的奶茶店。

现在，你想仿照`某颜悦色`开一家互联网古典系列奶茶店，你的初衷是利用互联网的优势，借助外卖这种途径，开一家网上直营店，节省了实体店的成本。

![chayanyuese](https://tva1.sinaimg.cn/large/008i3skNgy1gthmrn9nzyj60go0b4gn602.jpg)

你的奶茶定位于古典系列，通过取一些让人无法听懂的古典名字来增加自己的逼格。

![naicha](https://tva1.sinaimg.cn/large/008i3skNgy1gthmyne3sdj60qy0f6q4f02.jpg)

为了快速启动该项目，你先打算做一个MVP，在市场中试一试水，所以你先推出了`小杯常温奶茶`、`中杯常温奶茶`、`大杯常温奶茶`、`小杯加冰奶茶`、`中杯加冰奶茶`、`大杯加冰奶茶`、`小杯加热奶茶`、`中杯加热奶茶`、`大杯加热奶茶`等9款，
等到这几款奶茶获得消费者认可之后，在进一步推出一些其他类型的奶茶，比如水果味的，咖啡味的等。

现在，你想做一个网上点奶茶的系统来支撑你的互联网奶茶店的运营。作为程序猿出身的你，很快就想到了一个完满的解决方案：先定义一个抽象的奶茶类，不同类型的奶茶继承这个类，这样就可以实现多种不同的奶茶，同时还保持了未来的可扩展性。

但是，很快你就发现了问题的所在，如果奶茶有两个品类：杯子规格和温度，每个品类有三种，那么就有九种奶茶，你需要定义九个类，如果再增加一个品类：水果味，有十种口味，那么你就需要定义90个类来实现了。。。这显然是一场灾难！

基于这种需求，你可以需要使用`桥接模式`来实现了你的需求啦~

## 模式定义

***桥接模式是一种结构型设计模式， 可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构， 从而能在开发时分别使用。***

桥接模式用于把抽象化与实现化解耦，使得二者可以独立变化，主要解决的是产品在有多种维度变化的情况下，用继承会造成类爆炸的问题。解决的方式是把多角度分类分离出来，让它们独立变化，减少它们之间耦合。

我们的奶茶有多个品类，每个品类是需要独立的变化，所以我们需要使用此模式将变化的品类分离出来，使得他们独立变化，减少互相之间的依赖耦合。

## 模式结构

![bridge-construction](https://tva1.sinaimg.cn/large/008i3skNgy1gthoo102btj60v40lotb802.jpg)

1. **抽象部分(Abstraction):** 提供高层控制逻辑， 依赖于完成底层实际工作的实现对象。
2. **抽象实现部分(Implementatio):** 为所有具体实现声明通用接口。 抽象部分仅能通过在这里声明的方法与实现对象交互。 抽象部分可以列出和实现部分一样的方法， 但是抽象部分通常声明一些复杂行为， 这些行为依赖于多种由实现部分声明的原语操作。
3. **具体实现(Concrete Implementations):** 各个品类上面的具体实现。
4. **精确抽象(Refined Abstraction):** 提供控制逻辑的变体。 与其父类一样， 它们通过通用实现接口与不同的实现进行交互。
5. **客户端(Client):** 仅关心如何与抽象部分合作, 客户端需要将抽象对象与一个实现对象连接起来。

## 使用场景

1. **如果你想要拆分或重组一个具有多重功能的庞杂类，可以使用此模式。**
   
类的代码行数越多， 弄清其运作方式就越困难， 对其进行修改所花费的时间就越长。 一个功能上的变化可能需要在整个类范围内进行修改， 而且常常会产生错误， 甚至还会有一些严重的副作用。
桥接模式可以将庞杂类拆分为几个类层次结构。 此后， 你可以修改任意一个类层次结构而不会影响到其他类层次结构。 这种方法可以简化代码的维护工作， 并将修改已有代码的风险降到最低。

2. **如果你希望在几个独立维度上扩展一个类，可使用该模式**

桥接建议将每个维度抽取为独立的类层次。 初始类将相关工作委派给属于对应类层次的对象， 无需自己完成所有工作。

## 优缺点

### 优点
1. 你可以创建与平台无关的类和程序。
2. 客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息。
3. 开闭原则。 你可以新增抽象部分和实现部分， 且它们之间不会相互影响。
4. 单一职责原则。 抽象部分专注于处理高层逻辑， 实现部分处理平台细节。

### 缺点
1. 对高内聚的类使用该模式可能会让代码更加复杂。


